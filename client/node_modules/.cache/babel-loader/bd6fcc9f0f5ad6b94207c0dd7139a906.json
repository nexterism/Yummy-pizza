{"ast":null,"code":"import _slicedToArray from \"/Volumes/Disk D/work/Yummy Pizza/Yummy Pizza/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Volumes/Disk D/work/Yummy Pizza/Yummy Pizza/client/src/components/views/CartPage/CartPage.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { getCartItems, removeCartItem, onSuccessBuy } from \"../../../_actions/user_actions\";\nimport UserCardBlock from \"./Sections/UserCardBlock\";\nimport DELIVERY from \"./Sections/DELIVERY\";\nimport { Result, Empty, Button } from \"antd\";\nimport Axios from \"axios\";\nimport Paypal from \"../../utils/Paypal\";\n\nfunction CartPage(props) {\n  const dispatch = useDispatch();\n\n  const _useState = useState(0),\n        _useState2 = _slicedToArray(_useState, 2),\n        Total = _useState2[0],\n        setTotal = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        ShowTotal = _useState4[0],\n        setShowTotal = _useState4[1];\n\n  const _useState5 = useState(false),\n        _useState6 = _slicedToArray(_useState5, 2),\n        ShowSuccess = _useState6[0],\n        setShowSuccess = _useState6[1];\n\n  useEffect(() => {\n    let cartItems = [];\n\n    if (props.user.userData && props.user.userData.cart) {\n      if (props.user.userData.cart.length > 0) {\n        props.user.userData.cart.forEach(item => {\n          cartItems.push(item.id);\n        });\n        dispatch(getCartItems(cartItems, props.user.userData.cart)).then(response => {\n          if (response.payload.length > 0) {\n            calculateTotal(response.payload);\n          }\n        });\n      }\n    }\n  }, [props.user.userData]);\n\n  const calculateTotal = cartDetail => {\n    let total = 0;\n    cartDetail.map(item => {\n      total += parseInt(item.price, 10) * item.quantity;\n    });\n    setTotal(total);\n    setShowTotal(true);\n  };\n\n  const removeFromCart = productId => {\n    dispatch(removeCartItem(productId)).then(response => {\n      if (response.payload.cartDetail.length <= 0) {\n        setShowTotal(false);\n      } else {\n        calculateTotal(response.payload.cartDetail);\n      }\n    });\n  };\n\n  const transactionSuccess = data => {\n    let variables = {\n      cartDetail: props.user.cartDetail,\n      paymentData: data\n    };\n    Axios.post(\"./api/user/successBuy\", variables).then(response => {\n      if (response.data.success) {\n        setShowSuccess(true);\n        setShowTotal(false);\n        dispatch(onSuccessBuy({\n          cart: response.data.cart,\n          cartDetail: props.user.cartDetail\n        }));\n      } else {\n        alert(\"Failed\");\n      }\n    }); // dispatch(\n    //   onSuccessBuy({\n    //     cartDetail: props.user.cartDetail,\n    //     paymentData: data,\n    //   })\n    // ).then((response) => {\n    //   if (response.payload.success) {\n    //     setShowSuccess(true);\n    //     setShowTotal(false);\n    //   }\n    // });\n  };\n\n  const transactionError = () => {\n    console.log(\"Paypal error\");\n  };\n\n  const transactionCanceled = () => {\n    console.log(\"Transaction canceled\");\n  };\n\n  function handleClick(e) {\n    e.preventDefault();\n    alert(\"Your order is confirmed.\");\n  }\n\n  return React.createElement(\"div\", {\n    style: {\n      width: \"85%\",\n      margin: \" auto\",\n      position: \"relative\",\n      top: \"150px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"My Cart\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(UserCardBlock, {\n    products: props.user.cartDetail,\n    removeItem: removeFromCart,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }), ShowTotal ? React.createElement(\"div\", {\n    style: {\n      marginTop: \"3rem\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, \"Subtotal amount: $\", Total, \" \"), React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, \"Delivery amount: $\", 5, \" \"), React.createElement(\"hr\", {\n    style: {\n      width: \"25%\",\n      marginLeft: \"0\",\n      textAlign: \"left\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }), React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, \"Total amount: $\", Total + 5, \" \")) : ShowSuccess ? React.createElement(Result, {\n    status: \"success\",\n    title: \"Successfully Purchased Items\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }) : React.createElement(\"div\", {\n    style: {\n      width: \"100%\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"center\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }), React.createElement(Empty, {\n    description: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, \"No Items In the Cart\")), React.createElement(DELIVERY, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  })), ShowTotal && React.createElement(Paypal, {\n    toPay: Total,\n    onSuccess: transactionSuccess,\n    transactionError: transactionError,\n    transactionCanceled: transactionCanceled,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }));\n}\n\nexport default CartPage;","map":{"version":3,"sources":["/Volumes/Disk D/work/Yummy Pizza/Yummy Pizza/client/src/components/views/CartPage/CartPage.js"],"names":["React","useEffect","useState","useDispatch","getCartItems","removeCartItem","onSuccessBuy","UserCardBlock","DELIVERY","Result","Empty","Button","Axios","Paypal","CartPage","props","dispatch","Total","setTotal","ShowTotal","setShowTotal","ShowSuccess","setShowSuccess","cartItems","user","userData","cart","length","forEach","item","push","id","then","response","payload","calculateTotal","cartDetail","total","map","parseInt","price","quantity","removeFromCart","productId","transactionSuccess","data","variables","paymentData","post","success","alert","transactionError","console","log","transactionCanceled","handleClick","e","preventDefault","width","margin","position","top","marginTop","marginLeft","textAlign","display","flexDirection","justifyContent"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  getCartItems,\n  removeCartItem,\n  onSuccessBuy,\n} from \"../../../_actions/user_actions\";\nimport UserCardBlock from \"./Sections/UserCardBlock\";\nimport DELIVERY from \"./Sections/DELIVERY\";\nimport { Result, Empty, Button } from \"antd\";\nimport Axios from \"axios\";\nimport Paypal from \"../../utils/Paypal\";\n\nfunction CartPage(props) {\n  const dispatch = useDispatch();\n  const [Total, setTotal] = useState(0);\n  const [ShowTotal, setShowTotal] = useState(false);\n  const [ShowSuccess, setShowSuccess] = useState(false);\n\n  useEffect(() => {\n    let cartItems = [];\n    if (props.user.userData && props.user.userData.cart) {\n      if (props.user.userData.cart.length > 0) {\n        props.user.userData.cart.forEach((item) => {\n          cartItems.push(item.id);\n        });\n        dispatch(getCartItems(cartItems, props.user.userData.cart)).then(\n          (response) => {\n            if (response.payload.length > 0) {\n              calculateTotal(response.payload);\n            }\n          }\n        );\n      }\n    }\n  }, [props.user.userData]);\n\n  const calculateTotal = (cartDetail) => {\n    let total = 0;\n\n    cartDetail.map((item) => {\n      total += parseInt(item.price, 10) * item.quantity;\n    });\n\n    setTotal(total);\n    setShowTotal(true);\n  };\n\n  const removeFromCart = (productId) => {\n    dispatch(removeCartItem(productId)).then((response) => {\n      if (response.payload.cartDetail.length <= 0) {\n        setShowTotal(false);\n      } else {\n        calculateTotal(response.payload.cartDetail);\n      }\n    });\n  };\n  const transactionSuccess = (data) => {\n    let variables = {\n      cartDetail: props.user.cartDetail,\n      paymentData: data,\n    };\n    Axios.post(\"./api/user/successBuy\", variables).then((response) => {\n      if (response.data.success) {\n        setShowSuccess(true);\n        setShowTotal(false);\n\n        dispatch(\n          onSuccessBuy({\n            cart: response.data.cart,\n            cartDetail: props.user.cartDetail,\n          })\n        );\n      } else {\n        alert(\"Failed\");\n      }\n    });\n    // dispatch(\n    //   onSuccessBuy({\n    //     cartDetail: props.user.cartDetail,\n    //     paymentData: data,\n    //   })\n    // ).then((response) => {\n    //   if (response.payload.success) {\n    //     setShowSuccess(true);\n    //     setShowTotal(false);\n    //   }\n    // });\n  };\n\n  const transactionError = () => {\n    console.log(\"Paypal error\");\n  };\n\n  const transactionCanceled = () => {\n    console.log(\"Transaction canceled\");\n  };\n  function handleClick(e) {\n    e.preventDefault();\n    alert(\"Your order is confirmed.\");\n  }\n\n  return (\n    <div\n      style={{\n        width: \"85%\",\n        margin: \" auto\",\n        position: \"relative\",\n        top: \"150px\",\n      }}\n    >\n      <h1>My Cart</h1>\n      <div>\n        <UserCardBlock\n          products={props.user.cartDetail}\n          removeItem={removeFromCart}\n        />\n\n        {ShowTotal ? (\n          <div style={{ marginTop: \"3rem\" }}>\n            <h2>Subtotal amount: ${Total} </h2>\n            <h2>Delivery amount: ${5} </h2>\n            <hr\n              style={{ width: \"25%\", marginLeft: \"0\", textAlign: \"left\" }}\n            ></hr>\n            <h2>Total amount: ${Total + 5} </h2>\n          </div>\n        ) : ShowSuccess ? (\n          <Result status=\"success\" title=\"Successfully Purchased Items\" />\n        ) : (\n          <div\n            style={{\n              width: \"100%\",\n              display: \"flex\",\n              flexDirection: \"column\",\n              justifyContent: \"center\",\n            }}\n          >\n            <br />\n            <Empty description={false} />\n            <p>No Items In the Cart</p>\n          </div>\n        )}\n        <DELIVERY />\n      </div>\n      {/* <button onClick={<Result />}>CheckOut</button> */}\n      {/* Paypal Button */}\n\n      {ShowTotal && (\n        <Paypal\n          toPay={Total}\n          onSuccess={transactionSuccess}\n          transactionError={transactionError}\n          transactionCanceled={transactionCanceled}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default CartPage;\n"]},"metadata":{},"sourceType":"module"}